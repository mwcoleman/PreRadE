Validation sanity check:   0%|                                                                                                                                    | 0/2 [00:00<?, ?it/s]
Training: -1it [00:00, ?it/s]
Epoch 0:   2%|█▊                                                                     | 1/40 [00:00<00:10,  3.69it/s, loss=10.6, v_num=8t6j, train_loss_step=10.60, train_acc_step=0.000]
  | Name                 | Type                       | Params
--------------------------------------------------------------------
0 | model                | VisualBertModel            | 110 M
1 | text_prediction_head | VisualBertLMPredictionHead | 24.1 M
2 | seq_relationship     | Linear                     | 1.5 K
3 | transform_img_ft     | Linear                     | 1.0 M
4 | transform_img_box    | Linear                     | 5.1 K
5 | transform_ln_ft      | LayerNorm                  | 2.0 K
6 | transform_ln_box     | LayerNorm                  | 2.0 K
--------------------------------------------------------------------
135 M     Trainable params
0         Non-trainable params
135 M     Total params
543.152   Total estimated model params size (MB)
/home/matt/anaconda3/envs/lxmert/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:105: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 12 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/home/matt/anaconda3/envs/lxmert/lib/python3.8/site-packages/transformers/tokenization_utils_base.py:2211: FutureWarning: The `pad_to_max_length` argument is deprecated and will be removed in a future version, use `padding=True` or `padding='longest'` to pad to the longest sequence in the batch, or use `padding='max_length'` to pad to a max length. In this case, you can give a specific length with `max_length` (e.g. `max_length=45`) or leave max_length to None to pad to the maximal input size of the model (e.g. 512 for Bert).
  warnings.warn(
/home/matt/anaconda3/envs/lxmert/lib/python3.8/site-packages/pytorch_lightning/trainer/data_loading.py:105: UserWarning: The dataloader, train dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 12 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.




Epoch 0:  50%|███████████████████████████████████                                   | 20/40 [00:10<00:09,  2.08it/s, loss=8.67, v_num=8t6j, train_loss_step=8.270, train_acc_step=17.80]
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 0:  60%|██████████████████████████████████████████                            | 24/40 [00:10<00:06,  2.33it/s, loss=8.67, v_num=8t6j, train_loss_step=8.270, train_acc_step=17.80]


Validating:  60%|█████████████████████████████████████████████████████████████████████████████████                                                      | 12/20 [00:02<00:01,  4.45it/s]




Epoch 1:  50%|▌| 20/40 [00:10<00:09,  2.09it/s, loss=7.65, v_num=8t6j, train_loss_step=7.270, train_acc_step=25.60, val_loss_step=7.890, val_acc_step=20.30, val_loss_epoch=7.790, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 1:  60%|▌| 24/40 [00:10<00:06,  2.33it/s, loss=7.65, v_num=8t6j, train_loss_step=7.270, train_acc_step=25.60, val_loss_step=7.890, val_acc_step=20.30, val_loss_epoch=7.790, val_a


Validating:  60%|█████████████████████████████████████████████████████████████████████████████████                                                      | 12/20 [00:02<00:01,  4.49it/s]




Epoch 2:  50%|▌| 20/40 [00:10<00:09,  2.07it/s, loss=7.28, v_num=8t6j, train_loss_step=6.940, train_acc_step=28.60, val_loss_step=7.610, val_acc_step=21.80, val_loss_epoch=7.300, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 2:  55%|▌| 22/40 [00:10<00:08,  2.22it/s, loss=7.28, v_num=8t6j, train_loss_step=6.940, train_acc_step=28.60, val_loss_step=7.610, val_acc_step=21.80, val_loss_epoch=7.300, val_a


Validating:  55%|██████████████████████████████████████████████████████████████████████████▎                                                            | 11/20 [00:02<00:01,  4.52it/s]





Epoch 3:  50%|▌| 20/40 [00:10<00:09,  2.04it/s, loss=7.11, v_num=8t6j, train_loss_step=6.930, train_acc_step=30.10, val_loss_step=7.150, val_acc_step=27.60, val_loss_epoch=7.050, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 3:  70%|▋| 28/40 [00:11<00:04,  2.43it/s, loss=7.11, v_num=8t6j, train_loss_step=6.930, train_acc_step=30.10, val_loss_step=7.150, val_acc_step=27.60, val_loss_epoch=7.050, val_a


Validating:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 17/20 [00:03<00:00,  4.53it/s]




Epoch 4:  50%|▌| 20/40 [00:10<00:09,  2.05it/s, loss=6.96, v_num=8t6j, train_loss_step=6.960, train_acc_step=26.70, val_loss_step=7.210, val_acc_step=26.60, val_loss_epoch=6.980, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 4:  65%|▋| 26/40 [00:11<00:05,  2.35it/s, loss=6.96, v_num=8t6j, train_loss_step=6.960, train_acc_step=26.70, val_loss_step=7.210, val_acc_step=26.60, val_loss_epoch=6.980, val_a


Validating:  70%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                        | 14/20 [00:03<00:01,  4.40it/s]




Epoch 5:  50%|▌| 20/40 [00:10<00:10,  1.96it/s, loss=6.88, v_num=8t6j, train_loss_step=7.110, train_acc_step=26.50, val_loss_step=7.140, val_acc_step=25.60, val_loss_epoch=6.830, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 5:  55%|▌| 22/40 [00:10<00:08,  2.10it/s, loss=6.88, v_num=8t6j, train_loss_step=7.110, train_acc_step=26.50, val_loss_step=7.140, val_acc_step=25.60, val_loss_epoch=6.830, val_a



Validating:  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌             | 18/20 [00:04<00:00,  4.22it/s]




Epoch 6:  50%|▌| 20/40 [00:10<00:10,  1.99it/s, loss=6.7, v_num=8t6j, train_loss_step=6.880, train_acc_step=30.20, val_loss_step=6.990, val_acc_step=30.00, val_loss_epoch=6.670, val_ac
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 6:  65%|▋| 26/40 [00:11<00:06,  2.31it/s, loss=6.7, v_num=8t6j, train_loss_step=6.880, train_acc_step=30.20, val_loss_step=6.990, val_acc_step=30.00, val_loss_epoch=6.670, val_ac


Validating:  70%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                        | 14/20 [00:03<00:01,  4.54it/s]




Epoch 7:  50%|▌| 20/40 [00:10<00:10,  1.95it/s, loss=6.63, v_num=8t6j, train_loss_step=6.600, train_acc_step=35.00, val_loss_step=6.960, val_acc_step=28.80, val_loss_epoch=6.650, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 7:  55%|▌| 22/40 [00:11<00:08,  2.09it/s, loss=6.63, v_num=8t6j, train_loss_step=6.600, train_acc_step=35.00, val_loss_step=6.960, val_acc_step=28.80, val_loss_epoch=6.650, val_a



Validating:  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌             | 18/20 [00:04<00:00,  4.32it/s]




Epoch 8:  50%|▌| 20/40 [00:10<00:10,  2.00it/s, loss=6.54, v_num=8t6j, train_loss_step=6.510, train_acc_step=34.30, val_loss_step=6.920, val_acc_step=29.70, val_loss_epoch=6.580, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 8:  65%|▋| 26/40 [00:11<00:06,  2.32it/s, loss=6.54, v_num=8t6j, train_loss_step=6.510, train_acc_step=34.30, val_loss_step=6.920, val_acc_step=29.70, val_loss_epoch=6.580, val_a


Validating:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 15/20 [00:03<00:01,  4.36it/s]




Epoch 9:  50%|▌| 20/40 [00:10<00:09,  2.01it/s, loss=6.53, v_num=8t6j, train_loss_step=6.300, train_acc_step=37.00, val_loss_step=6.400, val_acc_step=34.90, val_loss_epoch=6.460, val_a
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 9:  60%|▌| 24/40 [00:11<00:07,  2.25it/s, loss=6.53, v_num=8t6j, train_loss_step=6.300, train_acc_step=37.00, val_loss_step=6.400, val_acc_step=34.90, val_loss_epoch=6.460, val_a


Validating:  60%|█████████████████████████████████████████████████████████████████████████████████                                                      | 12/20 [00:02<00:01,  4.51it/s]





Epoch 10:  50%|▌| 20/40 [00:10<00:09,  2.05it/s, loss=6.39, v_num=8t6j, train_loss_step=6.010, train_acc_step=37.70, val_loss_step=6.580, val_acc_step=33.30, val_loss_epoch=6.460, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 10:  70%|▋| 28/40 [00:11<00:04,  2.45it/s, loss=6.39, v_num=8t6j, train_loss_step=6.010, train_acc_step=37.70, val_loss_step=6.580, val_acc_step=33.30, val_loss_epoch=6.460, val_


Validating:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                           | 16/20 [00:03<00:00,  4.50it/s]




Epoch 11:  50%|▌| 20/40 [00:10<00:09,  2.09it/s, loss=6.38, v_num=8t6j, train_loss_step=6.000, train_acc_step=39.80, val_loss_step=6.570, val_acc_step=32.60, val_loss_epoch=6.390, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 11:  65%|▋| 26/40 [00:11<00:05,  2.41it/s, loss=6.38, v_num=8t6j, train_loss_step=6.000, train_acc_step=39.80, val_loss_step=6.570, val_acc_step=32.60, val_loss_epoch=6.390, val_


Validating:  75%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                 | 15/20 [00:03<00:01,  4.46it/s]




Epoch 12:  50%|▌| 20/40 [00:09<00:09,  2.10it/s, loss=6.38, v_num=8t6j, train_loss_step=6.340, train_acc_step=35.10, val_loss_step=6.720, val_acc_step=30.30, val_loss_epoch=6.380, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 12:  65%|▋| 26/40 [00:11<00:05,  2.42it/s, loss=6.38, v_num=8t6j, train_loss_step=6.340, train_acc_step=35.10, val_loss_step=6.720, val_acc_step=30.30, val_loss_epoch=6.380, val_


Validating:  70%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                        | 14/20 [00:03<00:01,  4.27it/s]




Epoch 13:  50%|▌| 20/40 [00:10<00:09,  2.06it/s, loss=6.33, v_num=8t6j, train_loss_step=5.950, train_acc_step=38.00, val_loss_step=6.630, val_acc_step=31.00, val_loss_epoch=6.390, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 13:  60%|▌| 24/40 [00:10<00:06,  2.29it/s, loss=6.33, v_num=8t6j, train_loss_step=5.950, train_acc_step=38.00, val_loss_step=6.630, val_acc_step=31.00, val_loss_epoch=6.390, val_


Validating:  55%|██████████████████████████████████████████████████████████████████████████▎                                                            | 11/20 [00:02<00:02,  4.42it/s]




Epoch 14:  50%|▌| 20/40 [00:10<00:09,  2.09it/s, loss=6.32, v_num=8t6j, train_loss_step=5.970, train_acc_step=38.50, val_loss_step=6.340, val_acc_step=35.00, val_loss_epoch=6.350, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 14:  55%|▌| 22/40 [00:10<00:08,  2.24it/s, loss=6.32, v_num=8t6j, train_loss_step=5.970, train_acc_step=38.50, val_loss_step=6.340, val_acc_step=35.00, val_loss_epoch=6.350, val_


Validating:  55%|██████████████████████████████████████████████████████████████████████████▎                                                            | 11/20 [00:02<00:02,  4.41it/s]




Epoch 15:  50%|▌| 20/40 [00:10<00:09,  2.10it/s, loss=6.33, v_num=8t6j, train_loss_step=6.020, train_acc_step=38.10, val_loss_step=6.320, val_acc_step=35.20, val_loss_epoch=6.350, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 15:  55%|▌| 22/40 [00:10<00:08,  2.25it/s, loss=6.33, v_num=8t6j, train_loss_step=6.020, train_acc_step=38.10, val_loss_step=6.320, val_acc_step=35.20, val_loss_epoch=6.350, val_


Validating:  50%|███████████████████████████████████████████████████████████████████▌                                                                   | 10/20 [00:02<00:02,  4.51it/s]




Epoch 16:  50%|▌| 20/40 [00:10<00:09,  2.08it/s, loss=6.26, v_num=8t6j, train_loss_step=6.320, train_acc_step=34.70, val_loss_step=6.550, val_acc_step=31.30, val_loss_epoch=6.290, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 16:  55%|▌| 22/40 [00:10<00:08,  2.23it/s, loss=6.26, v_num=8t6j, train_loss_step=6.320, train_acc_step=34.70, val_loss_step=6.550, val_acc_step=31.30, val_loss_epoch=6.290, val_


Validating:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 19/20 [00:04<00:00,  4.47it/s]





Epoch 17:  50%|▌| 20/40 [00:10<00:09,  2.07it/s, loss=6.32, v_num=8t6j, train_loss_step=6.250, train_acc_step=36.60, val_loss_step=6.650, val_acc_step=30.70, val_loss_epoch=6.310, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 17:  70%|▋| 28/40 [00:11<00:04,  2.48it/s, loss=6.32, v_num=8t6j, train_loss_step=6.250, train_acc_step=36.60, val_loss_step=6.650, val_acc_step=30.70, val_loss_epoch=6.310, val_


Validating:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 17/20 [00:03<00:00,  4.63it/s]




Epoch 18:  50%|▌| 20/40 [00:09<00:09,  2.11it/s, loss=6.24, v_num=8t6j, train_loss_step=6.650, train_acc_step=32.20, val_loss_step=6.390, val_acc_step=33.80, val_loss_epoch=6.200, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 18:  70%|▋| 28/40 [00:11<00:04,  2.51it/s, loss=6.24, v_num=8t6j, train_loss_step=6.650, train_acc_step=32.20, val_loss_step=6.390, val_acc_step=33.80, val_loss_epoch=6.200, val_


Validating:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 17/20 [00:03<00:00,  4.40it/s]




Epoch 19:  50%|▌| 20/40 [00:10<00:09,  2.01it/s, loss=6.17, v_num=8t6j, train_loss_step=5.960, train_acc_step=39.20, val_loss_step=6.450, val_acc_step=33.20, val_loss_epoch=6.200, val_
Validating:   0%|                                                                                                                                                | 0/20 [00:00<?, ?it/s]
Epoch 19:  60%|▌| 24/40 [00:11<00:07,  2.25it/s, loss=6.17, v_num=8t6j, train_loss_step=5.960, train_acc_step=39.20, val_loss_step=6.450, val_acc_step=33.20, val_loss_epoch=6.200, val_



Epoch 19: 100%|█| 40/40 [00:16<00:00,  2.43it/s, loss=6.17, v_num=8t6j, train_loss_step=5.960, train_acc_step=39.20, val_loss_step=6.680, val_acc_step=32.40, val_loss_epoch=6.190, val_